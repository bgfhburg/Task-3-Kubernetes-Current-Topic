apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: require-resource-limits
  annotations:
    policies.kyverno.io/title: Require Resource Limits
    policies.kyverno.io/category: Best Practices
    policies.kyverno.io/minversion: 1.6.0
    policies.kyverno.io/severity: medium
    policies.kyverno.io/subject: Pod
    policies.kyverno.io/description: >-
      It is a best practice to define resource limits for Pods to ensure
      proper resource allocation and avoid resource contention. This policy
      validates that resource limits are set for containers in the Pod.
spec:
  validationFailureAction: enforce
  background: true
  rules:
  - name: require-resource-limits
    match:
      any:
      - resources:
          kinds:
          - Pod
    validate:
      message: "Resource limits are required for containers in the Pod."
      pattern:
        spec:
          containers:
          - resources:
              limits:
                memory: "256Mi"
                cpu: "100m"
              requests:
                memory: "128Mi"
                cpu: "50m"
